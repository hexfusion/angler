#! /usr/bin/env perl

use strict;
use warnings;

use Dancer ':script';
use Angler::Schema;
use Dancer::Plugin::Interchange6;

set logger        => 'console';
set logger_format => '%m';

use Locale::SubCountry;
use DateTime qw();

my $now    = DateTime->now;
my $schema = shop_schema;
my $data;
my %product;

shop_schema->deploy({add_drop_table => 1});

my $state = $schema->resultset("State")->find( { country_iso_code => 'US', state_iso_code => 'NY' });
my $state_oregon = $schema->resultset("State")->find( { country_iso_code => 'US', state_iso_code => 'OR' });

# taxes
my $taxes = $schema->resultset("Tax")->create (
    {
        tax_name => 'nys_sales_tax',
        description => 'New York Sales Tax',
        percent => '8.0',
        valid_from => $now,
        country_iso_code => 'US',
        states_id => $state->id,
    }
);

# roles
my $roles = $schema->resultset("Role")->populate([
    { roles_id => '3', name => 'editor', label => 'Editor', description => 'Editor Role' },
    { roles_id => '4', name => 'pro', label => 'Pro Reviewer', description => 'Pro Role' },
    { roles_id => '5', name => 'staff', label => 'Shop Staff',description => 'Staff Role'  },
  ]);

my %users;

# Create user john
$users{john} = shop_user->create(
    { username => 'john@westbranchresort.com', password => 'Testing123', first_name => 'John',
      last_name => 'Miller', email => 'john@westbranchresort.com',
      created => $now,
      user_roles => [
          { roles_id => '4' },
      ],
  });

shop_address->create({
    users_id => $users{john}->id,
    first_name => $users{john}->first_name,
    last_name => $users{john}->last_name,
    type => 'shipping',
    address => '1212 Test Shipping Road',
    postal_code => '13783',
    city => 'Hancock',
    states_id => $state->id,
    country_iso_code => 'US',
    phone => '607-467-5525',
});

shop_address->create({
    users_id => $users{john}->id,
    first_name => $users{john}->first_name,
    last_name => $users{john}->last_name,
    type => 'billing',
    address => '1254 Test Billing Road',
    postal_code => '13783',
    city => 'Hancock',
    states_id => $state->id,
    country_iso_code => 'US',
});

# Create user ben
$users{ben} = shop_user->create(
    { username => 'ben@westbranchresort.com', password => 'Testing123', first_name => 'Ben',
      last_name => 'Sheard', email => 'ben@westbranchresort.com',
      created => $now,
      user_roles => [
          { roles_id => '5' },
      ],
  });

# Create user greg
$users{greg} = shop_user->create(
    { username => 'gregory@westbranchresort.com', password => 'Testing123', nickname => 'pike lover',
      first_name => 'Gregor', last_name => 'Fisherman',
      email => 'gregory@westbranchresort.com', created => $now,
      user_roles => [
        { roles_id => '3' },
      ],
  });

shop_address->create({
    users_id => $users{greg}->id,
    first_name => $users{greg}->first_name,
    last_name => $users{greg}->last_name,
    type => 'shipping',
    address => 'Crescent Ave',
    postal_code => '97403',
    city => 'Eugene',
    states_id => $state_oregon->id,
    country_iso_code => 'US',
    phone => '800-555-1212',
});

shop_address->create({
    users_id => $users{greg}->id,
    first_name => 'Agneta',
    last_name => 'Fisherfru',
    type => 'billing',
    address => 'Golden Ave',
    postal_code => '97203',
    city => 'Portland',
    states_id => $state_oregon->id,
    country_iso_code => 'US',
});

# Create user racke
$users{racke} = shop_user->create(
    { username => 'racke@westbranchresort.com', password => 'Testing123', nickname => 'toller Hecht',
      first_name => 'Stefan', last_name => 'Hornburg',
      email => 'racke@westbranchresort.com', created => $now,
      user_roles => [
        { roles_id => '3' },
      ],
  });

shop_address->create({
    users_id => $users{racke}->id,
    first_name => $users{racke}->first_name,
    last_name => $users{racke}->last_name,
    type => 'shipping',
    address => 'Crescent Ave',
    postal_code => '97403',
    city => 'Wedemark',
    country_iso_code => 'DE',
    phone => '+49.511.978200.19',
});

# Create user sam
$users{sam} = shop_user->create(
    { username => 'sbatschelet@mac.com', password => 'Testing123', nickname => 'trout lover',
      first_name => 'Sam', last_name => 'Batschelet',
      email => 'sbatschelet@mac.com', created => $now,
      user_roles => [
        { roles_id => '1' },
        { roles_id => '5' },
      ],
  });

shop_address->create({
    users_id => $users{sam}->id,
    first_name => $users{sam}->first_name,
    last_name => $users{sam}->last_name,
    type => 'shipping',
    address => '416 Twist Run Rd',
    postal_code => '13760',
    city => 'Endwell',
    states_id => $state->id,
    country_iso_code => 'US',
    phone => '607-245-9343',
});

# Create user admin
$users{admin} = shop_user->create(
    { username => 'admin', password => 'Westbranch1', nickname => 'God',
      first_name => '', last_name => '',
      email => 'sbatschelet@mac.com', created => $now,
      user_roles => [
        { roles_id => '1' },
      ],
  });


my $nav = $schema->resultset('Navigation')->populate([
# category roots - no parent_id
#my @nav = ([
{ navigation_id => '10', priority => '10', uri => 'fly-fishing-gear', type => 'menu', scope => 'root', description => 'Gear for fly fishing', name => 'Fly Fishing Gear' },
{ navigation_id => '20', priority => '20', uri => 'fly-fishing-gear/species', type => 'menu', scope => 'root', name => 'Species' , description => 'Fly Fishing Gear By Species'},
{ navigation_id => '30', priority => '30', uri => 'clothing', type => 'menu', scope => 'root', description => 'Clothing for fly fishing', name => 'Fly Fishing Clothing',  },
{ navigation_id => '31', priority => '31', uri => 'clothing/brand', type => 'menu', scope => 'root', description => 'Clothing By Brand', name => 'Fly Fishing Clothing By Brand',  },
{ navigation_id => '40', priority => '40', uri => 'fly-tying', type => 'menu', scope => 'root', description => 'Materials for fly tying', name => 'Fly Tying Materials and Supplies'},
{ navigation_id => '50', priority => '50', uri => 'flies', type => 'menu', scope => 'root', description => 'Flies for fishing', name => 'Fly Fishing Flies'},
{ navigation_id => '60', priority => '60', uri => 'gifts', type => 'menu', scope => 'root', description => 'Gifts for fishing', name => 'Fly Fishing Gifts'},
{ navigation_id => '70', priority => '70', uri => 'sale', type => 'menu', scope => 'root', description => 'Fly Fishing Gear on Sale!', name => 'Fly Fishing Gear on Sale!'},
{ navigation_id => '80', priority => '80', uri => 'pets', type => 'menu', scope => 'root', description => 'Great Gear for your pets', name => 'Great gear for your pets'},

# sub cats neg priority to hide from menus
{ navigation_id => '90', priority => '-1', uri => 'clothing/mens', type => 'menu', scope => 'header', description => 'Clothing for fly fishing', name => "Men's Clothing", parent_id =>'30' },

# gear
{ navigation_id => '100', priority => '200', uri => 'fly-fishing-gear/fly-rods', type => 'menu', scope => 'gear', description => 'Fly Rods', name => 'Fly Rods', parent_id =>'10' },
{ navigation_id => '101', priority => '300', uri => 'fly-fishing-gear/fly-reels', type => 'menu', scope => 'gear', description => 'Fly Reels', name => 'Fly Reels', parent_id =>'10' },
{ navigation_id => '102', priority => '400', uri => 'fly-fishing-gear/fly-line', type => 'menu', scope => 'gear', description => 'Fly Line & Backing', name => 'Fly Line & Backing', parent_id =>'10' },
{ navigation_id => '103', priority => '500', uri => 'fly-fishing-gear/waders', type => 'menu', scope => 'gear', description => 'Waders', name => 'Waders', parent_id =>'10' },
{ navigation_id => '104', priority => '600', uri => 'fly-fishing-gear/wading-boots', type => 'menu', scope => 'gear', description => 'Wading Boots', name => 'Wading Boots', parent_id =>'10' },
{ navigation_id => '105', priority => '610', uri => 'fly-fishing-gear/sunglasses', type => 'menu', scope => 'gear', description => 'Sunglasses', name => 'Sunglasses', parent_id =>'10' },
{ navigation_id => '106', priority => '900', uri => 'fly-fishing-gear/fly-boxes', type => 'menu', scope => 'gear', description => 'Fly Boxes', name => 'Fly Boxes', parent_id =>'10' },
{ navigation_id => '107', priority => '1000', uri => 'fly-fishing-gear/packs-vests', type => 'menu', scope => 'gear', description => 'Packs & Vests', name => 'Packs & Vests', parent_id =>'10' },
{ navigation_id => '108', priority => '1200', uri => 'fly-fishing-gear/leader-tippet', type => 'menu', scope => 'gear', description => 'Leader & Tippet', name => 'Leader & Tippet', parent_id =>'10' },
{ navigation_id => '109', priority => '1300', uri => 'fly-fishing-gear/tools-gadgets', type => 'menu', scope => 'gear', description => 'Tools & Gadgets', name => 'Tools & Gadgets', parent_id =>'10' },
{ navigation_id => '116', priority => '1350', uri => 'fly-fishing-gear/fishing-lights', type => 'menu', scope => 'gear', description => 'Fishing Lights', name => 'Fishing Lights', parent_id =>'10' },
{ navigation_id => '110', priority => '700', uri => 'fly-fishing-gear/bags-luggage', type => 'menu', scope => 'gear',  description => 'Bags & Luggage', name => 'Bags & Luggage', parent_id =>'10' },
{ navigation_id => '111', priority => '1500', uri => 'fly-fishing-gear/nets', type => 'menu', scope => 'gear',  description => 'Landing Nets', name => 'Landing Nets', parent_id =>'10' },
{ navigation_id => '112', priority => '800', uri => 'fly-fishing-gear/watercraft-boats', type => 'menu', scope => 'gear', description => 'Watercraft & Boats', name => 'Watercraft & Boats', parent_id =>'10' },
{ navigation_id => '113', priority => '1400', uri => 'fly-fishing-gear/books-dvds', type => 'menu', scope => 'gear',  description => 'Books & DVDs', name => 'Books & DVDs', parent_id =>'10' },
{ navigation_id => '114', priority => '1100', uri => 'fly-fishing-gear/fly-rod-combos', type => 'menu', scope => 'gear', description => 'Fly Rod Combos', name => 'Fly Rod Combos', parent_id =>'10' },
{ navigation_id => '115', priority => '100', uri => 'fly-fishing-gear/new', type => 'menu', scope => 'gear', name => 'New Products!' , description => 'New Fly Fishing Gear!', parent_id =>'10'},

# clothing
{ navigation_id => '200', priority => '200', uri => 'clothing/mens/jackets', type => 'menu', scope => 'clothing', name => 'Jackets', description => 'Mens Jackets and Outerwear for Fly Fishing', parent_id =>'30' },
{ navigation_id => '201', priority => '300', uri => 'clothing/mens/fleece', type => 'menu', scope => 'clothing', name => 'Fleece', description => 'Mens Fleece Layering for Fly Fishing', parent_id =>'30' },
{ navigation_id => '202', priority => '400', uri => 'clothing/mens/layering', type => 'menu', scope => 'clothing', name => 'Layering', description => 'Mens Base Layerting for Fly Fishing', parent_id =>'30' },
{ navigation_id => '203', priority => '500', uri => 'clothing/mens/shirts', type => 'menu', scope => 'clothing', name => 'Shirts', description => 'Mens Shirts for Fly Fishing', parent_id =>'30' },
{ navigation_id => '204', priority => '600', uri => 'clothing/mens/t-shirts', type => 'menu', scope => 'clothing', name => 'T-Shirts', description => 'Mens Fly Fishing T-Shirts', parent_id =>'30' },
{ navigation_id => '205', priority => '700', uri => 'clothing/mens/pants', type => 'menu', scope => 'clothing', name => 'Pants', description => 'Mens Fly Fishing Pants', parent_id =>'30' },
{ navigation_id => '206', priority => '800', uri => 'clothing/mens/underwear', type => 'menu', scope => 'clothing', name => 'Underwear', description => 'Mens Fly Fishing Underwear', parent_id =>'30' },
{ navigation_id => '207', priority => '900', uri => 'clothing/mens/hats', type => 'menu', scope => 'clothing', name => 'Hats', description => 'Mens Fly Fishing Hats', parent_id =>'30' },
{ navigation_id => '208', priority => '1000', uri => 'clothing/mens/wba-logo', type => 'menu', scope => 'clothing', name => 'WBA Logo Gear', description => 'WBA Logo Gear', parent_id =>'30' },
{ navigation_id => '209', priority => '1100', uri => 'clothing/mens/shorts', type => 'menu', scope => 'clothing', name => 'Shorts', description => 'Mens Fly Fishing Shorts', parent_id =>'30' },
{ navigation_id => '210', priority => '1200', uri => 'clothing/mens/socks', type => 'menu', scope => 'clothing', name => 'Socks', description => 'Mens Fly Fishing Socks', parent_id =>'30' },
{ navigation_id => '220', priority => '1300', uri => 'clothing/mens/gloves', type => 'menu', scope => 'clothing', name => 'Gloves', description => 'Mens Fly Fishing Gloves', parent_id =>'30' },

# clothing by brand
{ navigation_id => '300', priority => '100', uri => 'clothing/patagonia', type => 'menu', scope => 'clothing-brand', name => 'Patagonia', description => 'Patagonia Clothing', parent_id =>'31' },
{ navigation_id => '301', priority => '200', uri => 'clothing/simms', type => 'menu', scope => 'clothing-brand', name => 'Simms', description => 'Simms Clothing', parent_id =>'31' },
{ navigation_id => '302', priority => '300', uri => 'clothing/orvis', type => 'menu', scope => 'clothing-brand', name => 'Orvis', description => 'Orvis Clothing', parent_id =>'31' },
{ navigation_id => '303', priority => '400', uri => 'clothing/wba', type => 'menu', scope => 'clothing-brand', name => 'West Branch Angler', description => 'WBA Clothing', parent_id =>'31' },

# tying
{ navigation_id => '400', priority => '100', uri => 'fly-tying/tools', type => 'menu', scope => 'tying', name => 'Fly Tying Tools', description => 'Fly Tying Tools', parent_id =>'40' },
{ navigation_id => '401', priority => '200', uri => 'fly-tying/materials', type => 'menu', scope => 'tying', name => 'Fly Tying Materials', description => 'Fly Tying Materials', parent_id =>'40' },
{ navigation_id => '402', priority => '300', uri => 'fly-tying/hooks', type => 'menu', scope => 'tying', name => 'Fly Tying Hooks', description => 'Fly Tying Hooks', parent_id =>'40' },

# flies
{ navigation_id => '500', priority => '200', uri => 'flies/dries-emergers', type => 'menu', scope => 'flies', name => 'Dries and Emergers', description => 'Dries and Emergers', parent_id =>'50' },
{ navigation_id => '501', priority => '300', uri => 'flies/nymphs', type => 'menu', scope => 'flies', name => 'Nymphs', description => 'Nymphs', parent_id =>'50' },
{ navigation_id => '506', priority => '350', uri => 'flies/wet-flies', type => 'menu', scope => 'flies', name => 'Wet Flies', description => 'Wet Flies', parent_id =>'50' },
{ navigation_id => '502', priority => '400', uri => 'flies/streamers', type => 'menu', scope => 'flies', name => 'Streamers', description => 'Streamers', parent_id =>'50' },
{ navigation_id => '503', priority => '500', uri => 'flies/saltwater', type => 'menu', scope => 'flies', name => 'Saltwater Flies', description => 'Saltwater Flies', parent_id =>'50' },
{ navigation_id => '504', priority => '600', uri => 'flies/pike-bass-panfish', type => 'menu', scope => 'flies', name => 'Freshwater Pike, Bass, and Panfish Flies', description => 'Freshwater Pike, Bass, Panfish Flies', parent_id =>'50' },
{ navigation_id => '505', priority => '700', uri => 'flies/steelhead-salmon-flies', type => 'menu', scope => 'flies', name => 'Steelhead and Salmon Flies', description => 'Steelhead and Salmon Flies', parent_id =>'50' },
# species
{ navigation_id => '600', priority => '100', uri => 'fly-fishing-gear/trout', type => 'menu', scope => 'species', name => 'Trout' , description => 'Fly Fishing Gear for Trout', parent_id =>'20'},
{ navigation_id => '601',priority => '200', uri => 'fly-fishing-gear/steelhead', type => 'menu', scope => 'species', name => 'Steelhead' , description => 'Fly Fishing Gear for Steelhead', parent_id =>'20'},
{ navigation_id => '602', priority => '300', uri => 'fly-fishing-gear/salmon', type => 'menu', scope => 'species', name => 'Salmon' , description => 'Fly Fishing Gear for Salmon', parent_id =>'20'},
{ navigation_id => '603', priority => '400', uri => 'fly-fishing-gear/bonefish-permit', type => 'menu', scope => 'species', name => 'Bonefish - Permit' , description => 'Fly Fishing Gear for Bonefish and Permit', parent_id =>'20'},
{ navigation_id => '604', priority => '500', uri => 'fly-fishing-gear/tarpon', type => 'menu', scope => 'species', name => 'Tarpon' , description => 'Fly Fishing Gear for Tarpon', parent_id =>'20'},
{ navigation_id => '605', priority => '600', uri => 'fly-fishing-gear/striped-bass', type => 'menu', scope => 'species', name => 'Stripers' , description => 'Fly Fishing Gear for Striped Bass', parent_id =>'20'},

# manufactures
{ uri => 'simms', scope => 'manf', type => 'manufacturer', name => 'Simms Fishing Products', description => 'Simms', priority => '1' },
{ uri => 'patagonia', scope => 'manf', type => 'manufacturer', name => 'Patagonia', description => 'Patagonia', priority => '2'},
{ uri => 'orvis', scope => 'manf', type => 'manufacturer', name => 'The Orvis Company', description => 'Orvis', priority => '3' },
{ uri => 'sage', scope => 'manf', type => 'manufacturer', name => 'Sage',  description => 'Sage', priority => '4' },
{ uri => 'scott', scope => 'manf', type => 'manufacturer', name => 'Scott', description => 'Scott', priority => '5' },
{ uri => 'loomis', scope => 'manf', type => 'manufacturer', name => 'Loomis', description => 'Loomis', priority => '6' },
{ uri => 'hatch', scope => 'manf', type => 'manufacturer', name => 'Hatch Outdoors',  description => 'Hatch Outdoors', priority => '7' },

#nav
{ uri => 'contact', type => 'menu', scope => 'nav-top', description => 'Contact', name => 'Contact', priority => '1' },
{ uri => 'about-us', type => 'menu', scope => 'nav-top', description => 'About Us', name => 'About Us', priority => '1' },
{ uri => 'shipping', type => 'menu', scope => 'nav-top', description => 'Shipping', name => 'Shipping', priority => '1' },
{ uri => 'login', type => 'nav', scope => 'top-login', description => 'Login', name => 'Login', priority => '1' },
{ uri => 'registration', type => 'nav', scope => 'top-login', description => 'Sign Up', name => 'Sign Up', priority => '1' },
{ priority => '1300', uri => 'logout', type => 'nav', scope => 'top-logout', name => 'Logout', description => 'Logout' },
{ priority => '1400', uri => 'user/account', type => 'nav', scope => 'top-logout', name => 'My Account', description => 'My Account' },
]);

# populate navigation_products array

my @navigation_products = (
['WBA0003', '5', 'item'],
);

$schema->resultset('Attribute')->create(
    {
        name             => 'rweight',
        title            => 'Choose Weight',
        type             => 'variant',
        priority         => 1,
        attribute_values => [
            { value => '00',  title => '00WT' },
            { value => '0',  title => '0WT' },
            { value => '1',  title => '1WT' },
            { value => '2',  title => '2WT' },
            { value => '3',  title => '3WT' },
            { value => '4', title => '4WT' },
            { value => '5', title => '5WT' },
            { value => '6', title => '6WT' },
            { value => '7', title => '7WT' },
            { value => '9', title => '9WT' },
            { value => '10', title => '10WT' },
        ]
    }
);

$schema->resultset('Attribute')->create(
    {
        name             => 'length',
        title            => 'Choose Length',
        type             => 'variant',
        priority         => 1,
        attribute_values => [
            { value => '6',  title => '6FT' },
            { value => '7',  title => '7FT' },
            { value => '7_6', title => '7FT 6IN' },
            { value => '7_9', title => '7FT 9IN' },
            { value => '8_4', title => '8FT 4IN' },
            { value => '8_6', title => '8FT 6IN' },
            { value => '9', title => '9FT' },
            { value => '10', title => '10FT' },
        ]
    }
);

$schema->resultset('Attribute')->create(
    {
        name             => 'action',
        title            => 'Choose Action',
        type             => 'variant',
        priority         => 1,
        attribute_values => [
            { value => 'tip',  title => 'Tip Flex' },
            { value => 'mid',  title => 'Mid Flex' },
        ]
    }
);

$schema->resultset('Attribute')->create(
    {
        name             => 'pounds',
        title            => 'Choose Pound Stength',
        type             => 'variant',
        priority         => 1,
        attribute_values => [
            { value => '12',  title => '12 lb' },
            { value => '20',  title => '20 lb' },
            { value => '30',  title => '30 lb' },
        ]
    }
);

$schema->resultset('Attribute')->create(
    {
        name             => 'size',
        title            => 'Choose Size',
        type             => 'variant',
        priority         => 1,
        attribute_values => [
            { value => '5',  title => 'Mens 5' },
            { value => '6',  title => 'Mens 6' },
            { value => '7',  title => 'Mens 7' },
            { value => '8',  title => 'Mens 8' },
            { value => '9',  title => 'Mens 9' },
            { value => '10',  title => 'Mens 10' },
            { value => '11',  title => 'Mens 11' },
            { value => '12',  title => 'Mens 12' },
            { value => '13',  title => 'Mens 13' },
            { value => '14',  title => 'Mens 14' },
        ]
    }
);

$product{WBA0003} = $schema->resultset('Product')->create(
    {
        sku => 'WBA0003',
        manufacturer_sku => '',
        name => 'Orvis Helios 2 Fly Rod',
        short_description => 'When a customer asks is the Helios 2 really better than the Helios 1.  The answer is simple just cast it.',
        description => "Helios 2 fly rods are the best fly rods we have ever produced, period. Not only are these fly rods lightweight, sensitive and extremely powerful, they have an incredible look! Made in Manchester, Vermont, Helios 2 rods are the ultimate freshwater fly rods for all anglers. The fine-tuned tapers deliver spot-on accuracy and smooth tracking. Newly designed to be lighter in hand without compromising strength and power, the Helios 2 fly rods are making fly casting easier in all conditions. Available in three or four-piece sections, the Helios 2 fly rods come in all line weights for all fly-fishing applications. A custom-finished reel seat completes the sleek look of these freshwater fly rods, allowing the rod to stand out in a crowd. Pick up the Helios 2 and make a cast and you will realize instantly why these are the best fly rods made.",
        price => '795',
        uri => 'orvis-helios-2-fly-rod',
        weight => '5',
        inventory_exempt => '1',
    }
);

$product{WBA1001} = $schema->resultset('Product')->create(
    {
        sku => 'WBA1001',
        name => 'Orvis Hydros 3D WF Trout',
        manufacturer_sku => '',
        short_description => 'The finest textured fly line for trout you can put on a reel. Fully engineered with features to improve your cast and presentation for greater productivity on the stream.',
        description => "Enjoy the feel of minimal friction in your casting stroke. 3D texturing combined with IS, our most versatile trout taper, the new Hy-Flote Tip, and the new and improved welded loop, combine to offer the finest trout line we've ever offered.",
        price => '95',
        uri => 'orvis-hydros-3d-wf-trout',
        weight => '2',
        inventory_exempt => '1',
     }
);

$product{WBA2001} = $schema->resultset('Product')->create(
    {
        sku => 'WBA2001',
        manufacturer_sku => '',
        name => 'Orvis Fly Line Backing',
        short_description => "Quality backing can be the differnce between landing and losing the fish of a lifetime.",
        description => "Orvis uses the finest braid to make sure you are protected from abrasion.",
        price => '7.95',
        uri => 'orvis-backing',
        weight => '1',
        inventory_exempt => '1',
    }
);

$product{WBA8001} = $schema->resultset('Product')->create(
    {
        sku => 'WBA8001',
        manufacturer_sku => '',
        name => 'Patagonia Foot Tractor',
        short_description => "The Foot Tractor Wading Boot elevates our award winning, patent-pending aluminum bar technology to new levels of performance.",
        description => "<p>
Here’s the problem: Steel studs, cleats or screw heads are too hard—they skate down rock surfaces like fingernails on a blackboard. Felt wears out quickly, slides on mud and algae and can carry invasive species. Here’s the solution: Our new Foot Tractor Wading Boots with next-generation aluminum bar technology. The new, more aggressively shaped aluminum bars are just hard enough to cut through algae and slime, yet soft enough to conform to rock surfaces. They also grip well on muddy trails, won’t accumulate snow and don’t hold moisture. In other words, they offer the wading traction we’ve been looking for all our lives. Made with fast-drying synthetic leather and Venergy monofilament mesh panels, Foot Tractors offer industrial-strength support and protection in a light, comfortable boot.</p>
<p>
<h3>Features</h3>
<ul>
<li>Clarino® synthetic leather upper for the finest in lightweight and durability, even after extended flexing in wet environments</li>
<li>Venergy monofilament mesh paneling for quick drainage and weight reduction</li>
<li>Oversized toe box and heel cup feature Texon trilaminate to help protect heel and toe from rock impact and foot compression</li>
<li>Sticky rubber lugged sole with inset multi-directional gripping aluminum bar design</li>
<li>Clarino® synthetic leather upper with Venergy monofilament mesh panels. Texon trilaminate toe box and heel counter. Multidirectional gripping designed aluminum bars</li>
<li>1899 g (67 oz)</li><li>Made in China.</li>
</ul></p>", 
        price => '279',
        uri => 'patagonia-foot-tractor-wading-boots',
        weight => '5',
        inventory_exempt => '1',
    }
);

$schema->resultset('Product')->find( { sku => "WBA8001" } )->add_variants(
    {
        size => '5',
        manufacturer_sku => 'PA8002',
        sku    => 'WBA8002',
        uri    => 'patagonia-foot-tractor-wading-boots-size-5',
        price  => 279,
        weight => '5',
    },
    {
        size => '6',
        manufacturer_sku => 'PA8003',
        sku    => 'WBA8003',
        uri    => 'patagonia-foot-tractor-wading-boots-size-6',
        price  => 279,
        weight => '5',
    },
    {
        size => '7',
        manufacturer_sku => 'PA8004',
        sku    => 'WBA8004',
        uri    => 'patagonia-foot-tractor-wading-boots-size-7',
        price  => 279,
        weight => '5',
    },
    {
        size => '8',
        manufacturer_sku => 'PA8005',
        sku    => 'WBA8005',
        uri    => 'patagonia-foot-tractor-wading-boots-size-8',
        price  => 279,
        weight => '5',
    },
    {
        size => '9',
        manufacturer_sku => 'PA8006',
        sku    => 'WBA8006',
        uri    => 'patagonia-foot-tractor-wading-boots-size-9',
        price  => 279,
        weight => '5',
    },
    {
        size => '10',
        manufacturer_sku => 'PA8007',
        sku    => 'WBA8007',
        uri    => 'patagonia-foot-tractor-wading-boots-size-10',
        price  => 279,
        weight => '5',
    },
    {
        size => '11',
        manufacturer_sku => 'PA8008',
        sku    => 'WBA8008',
        uri    => 'patagonia-foot-tractor-wading-boots-size-11',
        price  => 279,
        weight => '5',
    },
    {
        size => '12',
        manufacturer_sku => 'PA8009',
        sku    => 'WBA8009',
        uri    => 'patagonia-foot-tractor-wading-boots-size-12',
        price  => 279,
        weight => '5',
    },
    {
        size => '13',
        manufacturer_sku => 'PA8010',
        sku    => 'WBA8010',
        uri    => 'patagonia-foot-tractor-wading-boots-size-13',
        price  => 279,
        weight => '5',
    },
    {
        size => '14',
        manufacturer_sku => 'PA8011',
        sku    => 'WBA8011',
        uri    => 'patagonia-foot-tractor-wading-boots-size-14',
        price  => 279,
        weight => '5',
    },
);

$schema->resultset('Product')->find( { sku => "WBA1001" } )->add_variants(
    {
        rweight => '3',
        manufacturer_sku => 'OR1002',
        sku    => 'WBA1002',
        uri    => 'orvis-hydros-3d-wf-trout-wf-3',
        price  => 95,
        weight => '5',
    },
    {
        rweight => '4',
        manufacturer_sku => 'OR1003',
        sku    => 'WBA1003',
        uri    => 'orvis-hydros-3d-wf-trout-wf-4',
        price  => 95,
        weight => '5',
    },
    {
        rweight => '5',
        manufacturer_sku => 'OR1003',
        sku    => 'WBA1004',
        uri    => 'orvis-hydros-3d-wf-trout-wf-5',
        price  => 95,
        weight => '5',
    },
    {
        rweight => '6',
        manufacturer_sku => 'OR1003',
        sku    => 'WBA1005',
        uri    => 'orvis-hydros-3d-wf-trout-wf-6',
        price  => 95,
        weight => '5',
    },
);

$schema->resultset('Product')->find( { sku => "WBA2001" } )->add_variants(
    {
        pounds => '12',
        sku    => 'WBA2002',
        manufacturer_sku => 'OR2002',
        uri    => 'orvis-backing-12lb',
        price  => '7.95',
        weight => '1',
    },
    {
        pounds => '20',
        sku    => 'WBA2003',
        manufacturer_sku => 'OR2003',
        uri    => 'orvis-backing-20lb',
        price  => 7.95,
        weight => '1',
    },
    {
        pounds => '30',
        manufacturer_sku => 'OR2004',
        sku    => 'WBA2004',
        uri    => 'orvis-backing-30lb',
        price  => '7.95',
        weight => '1',
    },
);

$schema->resultset('Product')->find( { sku => "WBA0003" } )->add_variants(
    {
        rweight => '2',
        length => '6',
        action => 'mid',
        manufacturer_sku => 'OR0001',
        sku    => 'WBA0001',
        name   => 'Orvis Helios 2 6ft 2wt 3pc Mid Flex',
        uri    => 'orvis-helios-2-620-3-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '2',
        length => '8_4',
        action => 'mid',
        manufacturer_sku => 'OR0002',
        sku    => 'WBA0002',
        name   => 'Orvis Helios 2 8ft 4in 2wt 4pc Mid Flex',
        uri    => 'orvis-helios-2-842-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '3',
        length => '7_6',
        action => 'mid',
        name   => 'Orvis Helios 2 7ft 6in 3wt 4pc Mid Flex',
        manufacturer_sku => 'OR0004',
        sku    => 'WBA0004',
        uri    => 'orvis-helios-2-376-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '3',
        length => '8_4',
        action => 'mid',
        name   => 'Orvis Helios 2 8ft 4in 3wt 4pc Tip Flex', 
        manufacturer_sku => 'OR0005',
        sku    => 'WBA0005',
        uri    => 'orvis-helios-2-384-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '3',
        length => '10',
        action => 'tip',
        name   => 'Orvis Helios 2 10ft 3wt 4pc Tip Flex',
        manufacturer_sku => 'OR0006',
        sku    => 'WBA0006',
        uri    => 'orvis-helios-2-3100-4-tip-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '4',
        length => '7',
        action => 'mid',
        name   => 'Orvis Helios 2 7ft 4wt 4pc Mid Flex',
        manufacturer_sku => 'OR0007',
        sku    => 'WBA0007',
        uri    => 'orvis-helios-2-470-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '4',
        length => '8_6',
        action => 'mid',
        name   => 'Orvis Helios 2 8ft 6in 4wt 4pc Mid Flex',
        manufacturer_sku => 'OR0008',
        sku    => 'WBA0008',
        uri    => 'orvis-helios-2-486-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '4',
        length => '9',
        action => 'mid',
        name   => 'Orvis Helios 2 9ft 4wt 4pc Mid Flex',
        manufacturer_sku => 'OR0009',
        sku    => 'WBA0009',
        uri    => 'orvis-helios-2-490-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '4',
        length => '9',
        action => 'tip',
        name   => 'Orvis Helios 2 9ft 4wt 4pc Tip Flex',
        manufacturer_sku => 'OR0010',
        sku    => 'WBA0010',
        uri    => 'orvis-helios-2-490-4-tip-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '4',
        length => '10',
        action => 'tip',
        name   => 'Orvis Helios 2 10ft 4wt 4pc Tip Flex',
        manufacturer_sku => 'OR0011',
        sku    => 'WBA0011',
        uri    => 'orvis-helios-2-4100-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '5',
        length => '7_9',
        action => 'mid',
        name   => 'Orvis Helios 2 7ft 9in 5wt 4pc Mid Flex',
        manufacturer_sku => 'OR0012',
        sku    => 'WBA0012',
        uri    => 'orvis-helios-2-579-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '5',
        length => '8_6',
        action => 'mid',
        name   => 'Orvis Helios 2 8ft 6in 5wt 4pc Mid Flex',
        manufacturer_sku => 'OR0013',
        sku    => 'WBA0013',
        uri    => 'orvis-helios-2-586-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '5',
        length => '8_6',
        action => 'tip',
        name   => 'Orvis Helios 2 8ft 6in 5wt 4pc Tip Flex',
        manufacturer_sku => 'OR0014',
        sku    => 'WBA0014',
        uri    => 'orvis-helios-2-586-4-tip-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '5',
        length => '9',
        action => 'mid',
        name   => 'Orvis Helios 2 9ft 5wt 4pc Mid Flex',
        manufacturer_sku => 'OR0015',
        sku    => 'WBA0015',
        uri    => 'orvis-helios-2-590-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '5',
        length => '9',
        action => 'tip',
        name   => 'Orvis Helios 2 9ft 5wt 4pc Tip Flex',
        manufacturer_sku => 'OR0016',
        sku    => 'WBA0016',
        uri    => 'orvis-helios-2-590-4-tip-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '5',
        length => '10',
        action => 'tip',
        name   => 'Orvis Helios 2 10ft 5wt 4pc Mid Flex',
        manufacturer_sku => 'OR0017',
        sku    => 'WBA0017',
        uri    => 'orvis-helios-2-5100-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '6',
        length => '9',
        action => 'mid',
        manufacturer_sku => 'OR0018',
        sku    => 'WBA0018',
        uri    => 'orvis-helios-2-690-4-mid-flex',
        price  => 795,
        weight => '5',
    },
    {
        rweight => '6',
        length => '9',
        action => 'tip',
        name   => 'Orvis Helios 2 9ft 6wt 4pc Tip Flex',
        manufacturer_sku => 'OR0019',
        sku    => 'WBA0019',
        uri    => 'orvis-helios-2-690-4-tip-flex',
        price  => 795,
        weight => '5',
    },
);

my $merch = $schema->resultset('MerchandisingProduct')->populate([
                                           { 
                                             sku => 'WBA0003', 
                                             sku_related => 'WBA1001',
                                             type => 'related' 
                                           },
                                           {
                                             sku => 'WBA0003',
                                             sku_related => 'WBA2001',
                                             type => 'related'
                                           },
                                          ]);

my $types = $schema->resultset('MediaType')->populate([
                                           { type => 'image' },
                                           { type => 'video' },
                                           { type => 'js' },
                                           { type => 'css' },
                                          ]);


my $images = $schema->resultset('MediaType')->find({ type => 'image' });
my $video = $schema->resultset('MediaType')->find({ type => 'video' });
my $css = $schema->resultset('MediaType')->find({ type => 'css' });
my $js = $schema->resultset('MediaType')->find({ type => 'js' });

# for now, call the type with the size

my @displays = (
    {
        name => 'cart_mini',
        size => '35x35',
        type => 'product_35x35'
    },
    {
        name => 'cart',
        size => '75x75',
        type => 'product_75x75'
    },
    {
        name => 'grid_list',
        size => '200x200',
        type => 'product_200x200',
    },
    {
        name => 'related',
        size => '110x110',
        type => 'product_110x110',
    },
    {
        name => 'flypage_glory',
        size => '325x325',
        type => 'product_325x325',
    },
    {
        name => 'flypage_zoom',
        size => '975x975',
        type => 'product_975x975',
    },
    {
        name => 'flypage_alt',
        size => '100x100',
        type => 'product_100x100',
    },
);


foreach my $record (@displays) {
    $images->add_to_media_displays({
                                    type => $record->{type},
                                    name => $record->{name},
                                    path => "/products/images/$record->{size}",
                                    size => $record->{size},});
}

# set default for example product
my $media = $schema->resultset('Media')->populate([
                            {
                                file => 'public/products/images/orvis_helios_2.jpg',
                                uri => 'orvis_helios_2.jpg',
                                mime_type => 'image/jpg',
                                media_types_id => $images->id,
                            },
                            {
                                file => 'public/images/products/optimized_jpgs/default.jpg',
                                uri => 'default.jpg',
                                mime_type => 'image/jpg',
                                media_types_id => $images->id,
                            },
                            {
                                file => 'public/products/images/patagonia_foot_tractor.jpg',
                                uri => 'patagonia_foot_tractor.jpg',
                                mime_type => 'image/jpg',
                                media_types_id => $images->id,
                            },
                            {
                                file => 'http://www.youtube.com/embed/P-UKSJnWWQE',
                                uri => 'http://www.youtube.com/embed/P-UKSJnWWQE',
                                media_types_id => $video->id,
                            },
                            {   file => 'http://www.youtube.com/embed/HfhpZPdrc2A',
                                uri => 'http://www.youtube.com/embed/HfhpZPdrc2A',
                                media_types_id => $video->id,
                            },
]);
# add all slider image assets
$media = $schema->resultset('Media')->populate([
                            {
                                file => 'public/images/camera/slides/slide1.jpg',
                                uri => 'slide1.jpg',
                                mime_type => 'image/jpg',
                                media_types_id => $images->id,
                                label => 'Delaware river fly fishing guide trip.'
                            },
                            {
                                file => 'public/images/camera/slides/slide2.jpg',
                                uri => 'slide2.jpg',
                                mime_type => 'image/jpg',
                                media_types_id => $images->id,
                                label => 'Delaware river wild brown trout.'
                            },
                            {
                                file => 'public/images/camera/slides/slide3.jpg',
                                uri => 'slide3.jpg',
                                mime_type => 'image/jpg',
                                media_types_id => $images->id,
                                label => 'Summer Sulphur on the Delaware.'
                            },
]);

# add all js/css assets
$media = $schema->resultset('Media')->populate([
                            {
                                file => 'public/css/rateit.css',
                                uri => 'rateit.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/css/css_002.css',
                                uri => 'css_002.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/css/css.css',
                                uri => 'css.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/css/font-awesome.css',
                                uri => 'font-awesome.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/css/jquery.css',
                                uri => 'jquery.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/css/photoswipe.css',
                                uri => 'photoswipe.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/css/bootstrap.css',
                                uri => 'bootstrap.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/css/extra_style.css',
                                uri => 'extra_style.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/css/styles.css',
                                uri => 'styles.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/css/responsive.css',
                                uri => 'responsive.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/css/superfish.css',
                                uri => 'superfish.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/css/camera.css',
                                uri => 'camera.css',
                                mime_type => 'text/css',
                                media_types_id => $css->id,
                            },
                            {
                                file => 'public/js/jquery-1.js',
                                uri => 'jquery-1.js',
                                mime_type => 'text/javascript',
                                media_types_id => $js->id,
                            },
                            {
                                file => 'public/js/jquery-migrate-1.js',
                                uri => 'jquery-migrate-1.js',
                                mime_type => 'text/javascript',
                                media_types_id => $js->id,
                            },
                            {
                                file => 'public/js/jquery.rateit.min.js',
                                uri => 'jquery.rateit.min.js',
                                mime_type => 'text/javascript',
                                media_types_id => $js->id,
                            },
                            {
                                file => 'public/js/superfish.js',
                                uri => 'superfish.js',
                                mime_type => 'text/javascript',
                                media_types_id => $js->id,
                            },
                            {
                                file => 'public/js/scripts.js',
                                uri => 'scripts.js',
                                mime_type => 'text/javascript',
                                media_types_id => $js->id,
                            },
                            {
                                file => 'public/js/bootstrap-hover-dropdown.js',
                                uri => 'bootstrap-hover-dropdown.js',
                                mime_type => 'text/javascript',
                                media_types_id => $js->id,
                            },
                            {
                                file => 'public/js/fitdivs.js',
                                uri => 'fitdivs.js',
                                mime_type => 'text/javascript',
                                media_types_id => $js->id,
                            },
]);

my $helios_image = $schema->resultset('Media')->find({ uri => 'orvis_helios_2.jpg' });
my $tractor = $schema->resultset('Media')->find({ uri => 'patagonia_foot_tractor.jpg' });
my $tractor_video = $schema->resultset('Media')->find({ uri => 'http://www.youtube.com/embed/P-UKSJnWWQE' });
my $helios_video = $schema->resultset('Media')->find({ uri => 'http://www.youtube.com/embed/HfhpZPdrc2A' });
my $orvis = $schema->resultset('Navigation')->find({ uri => 'orvis' });

$schema->resultset('MediaProduct')->populate([
                                           { media_id => $helios_image->id, sku => 'WBA0001' },
                                           { media_id => $helios_image->id, sku => 'WBA0002' },
                                           { media_id => $helios_image->id, sku => 'WBA0003' },
                                           { media_id => $helios_image->id, sku => 'WBA0004' },
                                           { media_id => $helios_image->id, sku => 'WBA0005' },
                                           { media_id => $helios_image->id, sku => 'WBA0006' },
                                           { media_id => $helios_image->id, sku => 'WBA0007' },
                                           { media_id => $helios_video->id, sku => 'WBA0001' },
                                           { media_id => $helios_video->id, sku => 'WBA0002' },
                                           { media_id => $helios_video->id, sku => 'WBA0003' },
                                           { media_id => $helios_video->id, sku => 'WBA0004' },
                                           { media_id => $helios_video->id, sku => 'WBA0005' },
                                           { media_id => $helios_video->id, sku => 'WBA0006' },
                                           { media_id => $helios_video->id, sku => 'WBA0007' },
                                          ]);

$schema->resultset('MediaProduct')->populate([
                                           { media_id => $tractor->id, sku => 'WBA8001' },
                                           { media_id => $tractor->id, sku => 'WBA8002' },
                                           { media_id => $tractor->id, sku => 'WBA8003' },
                                           { media_id => $tractor->id, sku => 'WBA8004' },
                                           { media_id => $tractor->id, sku => 'WBA8005' },
                                           { media_id => $tractor->id, sku => 'WBA8006' },
                                           { media_id => $tractor->id, sku => 'WBA8007' },
                                           { media_id => $tractor->id, sku => 'WBA8008' },
                                           { media_id => $tractor->id, sku => 'WBA8009' },
                                           { media_id => $tractor->id, sku => 'WBA8010' },
                                           { media_id => $tractor->id, sku => 'WBA8011' },
                                            #video
                                           { media_id => $tractor_video->id, sku => 'WBA8001' },
                                           { media_id => $tractor_video->id, sku => 'WBA8002' },
                                           { media_id => $tractor_video->id, sku => 'WBA8003' },
                                           { media_id => $tractor_video->id, sku => 'WBA8004' },
                                           { media_id => $tractor_video->id, sku => 'WBA8005' },
                                           { media_id => $tractor_video->id, sku => 'WBA8006' },
                                           { media_id => $tractor_video->id, sku => 'WBA8007' },
                                           { media_id => $tractor_video->id, sku => 'WBA8008' },
                                           { media_id => $tractor_video->id, sku => 'WBA8009' },
                                           { media_id => $tractor_video->id, sku => 'WBA8010' },
                                           { media_id => $tractor_video->id, sku => 'WBA8011' },
                                          ]);

my $rods = shop_navigation->find({ uri => 'fly-fishing-gear/fly-rods' });
my $new_nav = shop_navigation->find({ uri => 'fly-fishing-gear/new' });

$schema->resultset('NavigationProduct')->populate([
                                           { navigation_id => $rods->id, sku => 'WBA0001' },
                                           { navigation_id => $rods->id, sku => 'WBA0002' },
                                           { navigation_id => $rods->id, sku => 'WBA0003' },
                                           { navigation_id => $rods->id, sku => 'WBA0004' },
                                           { navigation_id => $rods->id, sku => 'WBA0005' },
                                           { navigation_id => $rods->id, sku => 'WBA0006' },
                                           { navigation_id => $rods->id, sku => 'WBA0007' },
                                           { navigation_id => $rods->id, sku => 'WBA0008' },
                                           { navigation_id => $rods->id, sku => 'WBA0009' },
                                           { navigation_id => $rods->id, sku => 'WBA0010' },
                                           { navigation_id => $rods->id, sku => 'WBA0011' },
                                           { navigation_id => $rods->id, sku => 'WBA0012' },
                                           { navigation_id => $rods->id, sku => 'WBA0013' },
                                           { navigation_id => $rods->id, sku => 'WBA0014' },
                                            # manf
                                           { navigation_id => $orvis->id, sku => 'WBA0001' },
                                           { navigation_id => $orvis->id, sku => 'WBA0002' },
                                           { navigation_id => $orvis->id, sku => 'WBA0003' },
                                           { navigation_id => $orvis->id, sku => 'WBA0004' },
                                           { navigation_id => $orvis->id, sku => 'WBA0005' },
                                           { navigation_id => $orvis->id, sku => 'WBA0006' },
                                           { navigation_id => $orvis->id, sku => 'WBA0007' },
                                           { navigation_id => $orvis->id, sku => 'WBA0008' },
                                           { navigation_id => $orvis->id, sku => 'WBA0009' },
                                           { navigation_id => $orvis->id, sku => 'WBA0010' },
                                           { navigation_id => $orvis->id, sku => 'WBA0011' },
                                           { navigation_id => $orvis->id, sku => 'WBA0012' },
                                           { navigation_id => $orvis->id, sku => 'WBA0013' },
                                           { navigation_id => $orvis->id, sku => 'WBA0014' },
                                           # new tractors
                                           { navigation_id => $new_nav->id, sku => 'WBA8001' },

]);

$product{WBA0003}->add_to_reviews(
                    {
                    title           => 'Wow just wht the doctor ordered!',
                    message_types_id   => '3',
                    content         => "The Helios 2 fly rod changed my life I can't say enough good things about it.",
                    author_users_id          =>  $users{john}->id,
                    rating          => '5.0',
                    recommend       => '1',
                    public          => '1',
                    approved        => '1',
                    approved_by_users_id     => $users{sam}->id,
                 },
);

$schema->resultset('Product')->find( { sku => "WBA0017" } )->add_to_reviews(
                                    {
                                        title           => 'Dont sell the farm just yet',
                                        message_types_id   => '3',
                                        content         => "It's a fine rod but to me it's way over priced.",
                                        author_users_id          =>  $users{ben}->id,
                                        rating          => '3.5',
                                        recommend       => '1',
                                        public          => '1',
                                        approved        => '1',
                                        approved_by_users_id     => $users{sam}->id,
                                    },
);

my @us_postal_zones = (
[ 'NY' , '005' ],
[ 'PR' , '006' ],
[ 'PR' , '007' ],
[ 'PR' , '008' ],
[ 'PR' , '009' ],
[ 'CT' , '010' ],
[ 'CT' , '011' ],
[ 'CT' , '012' ],
[ 'MA' , '013' ],
[ 'MA' , '014' ],
[ 'MA' , '015' ],
[ 'MA' , '016' ],
[ 'MA' , '017' ],
[ 'MA' , '018' ],
[ 'MA' , '019' ],
[ 'MA' , '020' ],
[ 'MA' , '021' ],
[ 'MA' , '022' ],
[ 'MA' , '023' ],
[ 'MA' , '024' ],
[ 'RI' , '025' ],
[ 'RI' , '026' ],
[ 'RI' , '027' ],
[ 'RI' , '028' ],
[ 'RI' , '029' ],
[ 'NH' , '030' ],
[ 'NH' , '031' ],
[ 'NH' , '032' ],
[ 'NH' , '033' ],
[ 'NH' , '034' ],
[ 'VT' , '035' ],
[ 'VT' , '036' ],
[ 'VT' , '037' ],
[ 'NH' , '038' ],
[ 'ME' , '039' ],
[ 'ME' , '040' ],
[ 'ME' , '041' ],
[ 'ME' , '042' ],
[ 'ME' , '043' ],
[ 'ME' , '044' ],
[ 'ME' , '045' ],
[ 'ME' , '046' ],
[ 'ME' , '047' ],
[ 'ME' , '048' ],
[ 'ME' , '049' ],
[ 'VT' , '050' ],
[ 'VT' , '051' ],
[ 'VT' , '052' ],
[ 'VT' , '053' ],
[ 'VT' , '054' ],
[ 'MA' , '055' ],
[ 'VT' , '056' ],
[ 'VT' , '057' ],
[ 'VT' , '058' ],
[ 'VT' , '059' ],
[ 'CT' , '060' ],
[ 'CT' , '061' ],
[ 'CT' , '062' ],
[ 'CT' , '063' ],
[ 'CT' , '064' ],
[ 'CT' , '065' ],
[ 'NY' , '066' ],
[ 'CT' , '067' ],
[ 'NY' , '068' ],
[ 'NY' , '069' ],
[ 'NJ' , '070' ],
[ 'NJ' , '071' ],
[ 'NJ' , '072' ],
[ 'NJ' , '073' ],
[ 'NJ' , '074' ],
[ 'NJ' , '075' ],
[ 'NJ' , '076' ],
[ 'NJ' , '077' ],
[ 'NJ' , '078' ],
[ 'NJ' , '079' ],
[ 'NJ' , '080' ],
[ 'NJ' , '081' ],
[ 'NJ' , '082' ],
[ 'NJ' , '083' ],
[ 'NJ' , '084' ],
[ 'NJ' , '085' ],
[ 'NJ' , '086' ],
[ 'NJ' , '087' ],
[ 'NJ' , '088' ],
[ 'NJ' , '089' ],
[ 'AE' , '090' ],
[ 'AE' , '091' ],
[ 'AE' , '092' ],
[ 'AE' , '093' ],
[ 'AE' , '094' ],
[ 'AE' , '095' ],
[ 'AE' , '096' ],
[ 'AE' , '097' ],
[ 'AE' , '098' ],
[ 'NY' , '100' ],
[ 'NY' , '101' ],
[ 'NY' , '102' ],
[ 'NY' , '103' ],
[ 'NY' , '104' ],
[ 'NY' , '105' ],
[ 'NY' , '106' ],
[ 'NY' , '107' ],
[ 'NY' , '108' ],
[ 'NY' , '109' ],
[ 'NY' , '110' ],
[ 'NY' , '111' ],
[ 'NY' , '112' ],
[ 'NY' , '113' ],
[ 'NY' , '114' ],
[ 'NY' , '115' ],
[ 'NY' , '116' ],
[ 'NY' , '117' ],
[ 'NY' , '118' ],
[ 'NY' , '119' ],
[ 'NY' , '120' ],
[ 'NY' , '121' ],
[ 'NY' , '122' ],
[ 'NY' , '123' ],
[ 'NY' , '124' ],
[ 'NY' , '125' ],
[ 'NY' , '126' ],
[ 'NY' , '127' ],
[ 'NY' , '128' ],
[ 'NY' , '129' ],
[ 'NY' , '130' ],
[ 'NY' , '131' ],
[ 'NY' , '132' ],
[ 'NY' , '133' ],
[ 'NY' , '134' ],
[ 'NY' , '135' ],
[ 'NY' , '136' ],
[ 'NY' , '137' ],
[ 'NY' , '138' ],
[ 'NY' , '139' ],
[ 'NY' , '140' ],
[ 'NY' , '141' ],
[ 'NY' , '142' ],
[ 'NY' , '143' ],
[ 'NY' , '144' ],
[ 'NY' , '145' ],
[ 'NY' , '146' ],
[ 'NY' , '147' ],
[ 'NY' , '148' ],
[ 'NY' , '149' ],
[ 'PA' , '150' ],
[ 'PA' , '151' ],
[ 'PA' , '152' ],
[ 'PA' , '153' ],
[ 'PA' , '154' ],
[ 'PA' , '155' ],
[ 'PA' , '156' ],
[ 'PA' , '157' ],
[ 'PA' , '158' ],
[ 'PA' , '159' ],
[ 'PA' , '160' ],
[ 'PA' , '161' ],
[ 'PA' , '162' ],
[ 'PA' , '163' ],
[ 'PA' , '164' ],
[ 'PA' , '165' ],
[ 'PA' , '166' ],
[ 'PA' , '167' ],
[ 'PA' , '168' ],
[ 'PA' , '169' ],
[ 'PA' , '170' ],
[ 'PA' , '171' ],
[ 'PA' , '172' ],
[ 'PA' , '173' ],
[ 'PA' , '174' ],
[ 'PA' , '175' ],
[ 'PA' , '176' ],
[ 'PA' , '177' ],
[ 'PA' , '178' ],
[ 'PA' , '179' ],
[ 'PA' , '180' ],
[ 'PA' , '181' ],
[ 'PA' , '182' ],
[ 'PA' , '183' ],
[ 'PA' , '184' ],
[ 'PA' , '185' ],
[ 'PA' , '186' ],
[ 'PA' , '187' ],
[ 'PA' , '188' ],
[ 'PA' , '189' ],
[ 'PA' , '190' ],
[ 'PA' , '191' ],
[ 'PA' , '192' ],
[ 'DE' , '193' ],
[ 'PA' , '194' ],
[ 'PA' , '195' ],
[ 'PA' , '196' ],
[ 'DE' , '197' ],
[ 'DE' , '198' ],
[ 'DE' , '199' ],
[ 'DC' , '200' ],
[ 'VA' , '201' ],
[ 'DC' , '202' ],
[ 'DC' , '203' ],
[ 'DC' , '204' ],
[ 'DC' , '205' ],
[ 'MD' , '206' ],
[ 'MD' , '207' ],
[ 'MD' , '208' ],
[ 'MD' , '209' ],
[ 'MD' , '210' ],
[ 'MD' , '211' ],
[ 'MD' , '212' ],
[ 'MD' , '214' ],
[ 'MD' , '215' ],
[ 'MD' , '216' ],
[ 'MD' , '217' ],
[ 'MD' , '218' ],
[ 'MD' , '219' ],
[ 'VA' , '220' ],
[ 'VA' , '221' ],
[ 'VA' , '222' ],
[ 'VA' , '223' ],
[ 'VA' , '224' ],
[ 'VA' , '225' ],
[ 'VA' , '226' ],
[ 'VA' , '227' ],
[ 'VA' , '228' ],
[ 'VA' , '229' ],
[ 'VA' , '230' ],
[ 'VA' , '231' ],
[ 'VA' , '232' ],
[ 'VA' , '233' ],
[ 'VA' , '234' ],
[ 'VA' , '235' ],
[ 'VA' , '236' ],
[ 'VA' , '237' ],
[ 'VA' , '238' ],
[ 'VA' , '239' ],
[ 'VA' , '240' ],
[ 'VA' , '241' ],
[ 'TN' , '242' ],
[ 'VA' , '243' ],
[ 'VA' , '244' ],
[ 'VA' , '245' ],
[ 'WV' , '246' ],
[ 'WV' , '247' ],
[ 'WV' , '248' ],
[ 'WV' , '249' ],
[ 'WV' , '250' ],
[ 'WV' , '251' ],
[ 'WV' , '252' ],
[ 'WV' , '253' ],
[ 'MD' , '254' ],
[ 'WV' , '255' ],
[ 'WV' , '256' ],
[ 'WV' , '257' ],
[ 'WV' , '258' ],
[ 'WV' , '259' ],
[ 'PA' , '260' ],
[ 'WV' , '261' ],
[ 'WV' , '262' ],
[ 'WV' , '263' ],
[ 'WV' , '264' ],
[ 'PA' , '265' ],
[ 'WV' , '266' ],
[ 'MD' , '267' ],
[ 'VA' , '268' ],
[ 'NC' , '270' ],
[ 'NC' , '271' ],
[ 'NC' , '272' ],
[ 'NC' , '273' ],
[ 'NC' , '274' ],
[ 'NC' , '275' ],
[ 'NC' , '276' ],
[ 'NC' , '277' ],
[ 'NC' , '278' ],
[ 'NC' , '279' ],
[ 'NC' , '280' ],
[ 'NC' , '281' ],
[ 'NC' , '282' ],
[ 'NC' , '283' ],
[ 'NC' , '284' ],
[ 'NC' , '285' ],
[ 'NC' , '286' ],
[ 'NC' , '287' ],
[ 'NC' , '288' ],
[ 'NC' , '289' ],
[ 'SC' , '290' ],
[ 'SC' , '291' ],
[ 'SC' , '292' ],
[ 'SC' , '293' ],
[ 'SC' , '294' ],
[ 'SC' , '295' ],
[ 'SC' , '296' ],
[ 'NC' , '297' ],
[ 'GA' , '298' ],
[ 'SC' , '299' ],
[ 'GA' , '300' ],
[ 'GA' , '301' ],
[ 'GA' , '302' ],
[ 'GA' , '303' ],
[ 'GA' , '304' ],
[ 'GA' , '305' ],
[ 'GA' , '306' ],
[ 'TN' , '307' ],
[ 'GA' , '308' ],
[ 'GA' , '309' ],
[ 'GA' , '310' ],
[ 'GA' , '311' ],
[ 'GA' , '312' ],
[ 'FL' , '313' ],
[ 'FL' , '314' ],
[ 'FL' , '315' ],
[ 'FL' , '316' ],
[ 'FL' , '317' ],
[ 'GA' , '318' ],
[ 'GA' , '319' ],
[ 'FL' , '320' ],
[ 'FL' , '321' ],
[ 'FL' , '322' ],
[ 'FL' , '323' ],
[ 'FL' , '324' ],
[ 'FL' , '325' ],
[ 'FL' , '326' ],
[ 'FL' , '327' ],
[ 'FL' , '328' ],
[ 'FL' , '329' ],
[ 'FL' , '330' ],
[ 'FL' , '331' ],
[ 'FL' , '332' ],
[ 'FL' , '333' ],
[ 'FL' , '334' ],
[ 'FL' , '335' ],
[ 'FL' , '336' ],
[ 'FL' , '337' ],
[ 'FL' , '338' ],
[ 'FL' , '339' ],
[ 'FL' , '340' ],
[ 'FL' , '341' ],
[ 'FL' , '342' ],
[ 'FL' , '344' ],
[ 'FL' , '346' ],
[ 'FL' , '347' ],
[ 'FL' , '349' ],
[ 'AL' , '350' ],
[ 'AL' , '351' ],
[ 'AL' , '352' ],
[ 'AL' , '354' ],
[ 'AL' , '355' ],
[ 'AL' , '356' ],
[ 'AL' , '357' ],
[ 'AL' , '358' ],
[ 'AL' , '359' ],
[ 'AL' , '360' ],
[ 'AL' , '361' ],
[ 'AL' , '362' ],
[ 'AL' , '363' ],
[ 'AL' , '364' ],
[ 'AL' , '365' ],
[ 'AL' , '366' ],
[ 'AL' , '367' ],
[ 'AL' , '368' ],
[ 'MS' , '369' ],
[ 'TN' , '370' ],
[ 'TN' , '371' ],
[ 'TN' , '372' ],
[ 'TN' , '373' ],
[ 'TN' , '374' ],
[ 'TN' , '375' ],
[ 'TN' , '376' ],
[ 'TN' , '377' ],
[ 'TN' , '378' ],
[ 'TN' , '379' ],
[ 'TN' , '380' ],
[ 'TN' , '381' ],
[ 'TN' , '382' ],
[ 'TN' , '383' ],
[ 'TN' , '384' ],
[ 'TN' , '385' ],
[ 'TN' , '386' ],
[ 'MS' , '387' ],
[ 'TN' , '388' ],
[ 'MS' , '389' ],
[ 'MS' , '390' ],
[ 'MS' , '391' ],
[ 'MS' , '392' ],
[ 'MS' , '393' ],
[ 'MS' , '394' ],
[ 'MS' , '395' ],
[ 'MS' , '396' ],
[ 'MS' , '397' ],
[ 'FL' , '398' ],
[ 'GA' , '399' ],
[ 'KY' , '400' ],
[ 'KY' , '401' ],
[ 'KY' , '402' ],
[ 'KY' , '403' ],
[ 'KY' , '404' ],
[ 'KY' , '405' ],
[ 'KY' , '406' ],
[ 'TN' , '407' ],
[ 'TN' , '408' ],
[ 'TN' , '409' ],
[ 'OH' , '410' ],
[ 'WV' , '411' ],
[ 'WV' , '412' ],
[ 'KY' , '413' ],
[ 'KY' , '414' ],
[ 'WV' , '415' ],
[ 'WV' , '416' ],
[ 'TN' , '417' ],
[ 'TN' , '418' ],
[ 'KY' , '420' ],
[ 'TN' , '421' ],
[ 'TN' , '422' ],
[ 'IN' , '423' ],
[ 'IN' , '424' ],
[ 'TN' , '425' ],
[ 'TN' , '426' ],
[ 'KY' , '427' ],
[ 'OH' , '430' ],
[ 'OH' , '431' ],
[ 'OH' , '432' ],
[ 'OH' , '433' ],
[ 'OH' , '434' ],
[ 'OH' , '435' ],
[ 'OH' , '436' ],
[ 'OH' , '437' ],
[ 'OH' , '438' ],
[ 'PA' , '439' ],
[ 'OH' , '440' ],
[ 'OH' , '441' ],
[ 'OH' , '442' ],
[ 'OH' , '443' ],
[ 'OH' , '444' ],
[ 'OH' , '445' ],
[ 'OH' , '446' ],
[ 'OH' , '447' ],
[ 'OH' , '448' ],
[ 'OH' , '449' ],
[ 'OH' , '450' ],
[ 'OH' , '451' ],
[ 'OH' , '452' ],
[ 'OH' , '453' ],
[ 'OH' , '454' ],
[ 'OH' , '455' ],
[ 'OH' , '456' ],
[ 'OH' , '457' ],
[ 'OH' , '458' ],
[ 'OH' , '459' ],
[ 'IN' , '460' ],
[ 'IN' , '461' ],
[ 'IN' , '462' ],
[ 'IN' , '463' ],
[ 'IN' , '464' ],
[ 'IN' , '465' ],
[ 'IN' , '466' ],
[ 'IN' , '467' ],
[ 'IN' , '468' ],
[ 'IN' , '469' ],
[ 'OH' , '470' ],
[ 'KY' , '471' ],
[ 'IN' , '472' ],
[ 'IN' , '473' ],
[ 'IN' , '474' ],
[ 'IN' , '475' ],
[ 'IN' , '476' ],
[ 'IN' , '477' ],
[ 'IN' , '478' ],
[ 'IN' , '479' ],
[ 'MI' , '480' ],
[ 'MI' , '481' ],
[ 'MI' , '482' ],
[ 'MI' , '483' ],
[ 'MI' , '484' ],
[ 'MI' , '485' ],
[ 'MI' , '486' ],
[ 'MI' , '487' ],
[ 'MI' , '488' ],
[ 'MI' , '489' ],
[ 'MI' , '490' ],
[ 'MI' , '491' ],
[ 'MI' , '492' ],
[ 'MI' , '493' ],
[ 'MI' , '494' ],
[ 'MI' , '495' ],
[ 'MI' , '496' ],
[ 'MI' , '497' ],
[ 'MI' , '498' ],
[ 'MI' , '499' ],
[ 'IA' , '500' ],
[ 'IA' , '501' ],
[ 'IA' , '502' ],
[ 'IA' , '503' ],
[ 'IA' , '504' ],
[ 'IA' , '505' ],
[ 'IA' , '506' ],
[ 'IA' , '507' ],
[ 'IA' , '508' ],
[ 'IA' , '509' ],
[ 'SD' , '510' ],
[ 'SD' , '511' ],
[ 'SD' , '512' ],
[ 'SD' , '513' ],
[ 'IA' , '514' ],
[ 'NE' , '515' ],
[ 'NE' , '516' ],
[ 'IA' , '520' ],
[ 'IA' , '521' ],
[ 'IA' , '522' ],
[ 'IA' , '523' ],
[ 'IA' , '524' ],
[ 'IA' , '525' ],
[ 'IL' , '526' ],
[ 'IL' , '527' ],
[ 'IA' , '528' ],
[ 'WI' , '530' ],
[ 'WI' , '531' ],
[ 'WI' , '532' ],
[ 'WI' , '534' ],
[ 'WI' , '535' ],
[ 'WI' , '537' ],
[ 'WI' , '538' ],
[ 'WI' , '539' ],
[ 'MN' , '540' ],
[ 'WI' , '541' ],
[ 'WI' , '542' ],
[ 'WI' , '543' ],
[ 'WI' , '544' ],
[ 'WI' , '545' ],
[ 'WI' , '546' ],
[ 'WI' , '547' ],
[ 'WI' , '548' ],
[ 'WI' , '549' ],
[ 'MN' , '550' ],
[ 'MN' , '551' ],
[ 'MN' , '553' ],
[ 'MN' , '554' ],
[ 'MN' , '555' ],
[ 'MN' , '556' ],
[ 'MN' , '557' ],
[ 'MN' , '558' ],
[ 'MN' , '559' ],
[ 'MN' , '560' ],
[ 'MN' , '561' ],
[ 'MN' , '562' ],
[ 'MN' , '563' ],
[ 'MN' , '564' ],
[ 'ND' , '565' ],
[ 'MN' , '566' ],
[ 'ND' , '567' ],
[ 'SD' , '570' ],
[ 'SD' , '571' ],
[ 'SD' , '572' ],
[ 'SD' , '573' ],
[ 'SD' , '574' ],
[ 'SD' , '575' ],
[ 'ND' , '576' ],
[ 'SD' , '577' ],
[ 'ND' , '580' ],
[ 'ND' , '581' ],
[ 'ND' , '582' ],
[ 'ND' , '583' ],
[ 'ND' , '584' ],
[ 'ND' , '585' ],
[ 'ND' , '586' ],
[ 'ND' , '587' ],
[ 'ND' , '588' ],
[ 'MT' , '590' ],
[ 'MT' , '591' ],
[ 'MT' , '592' ],
[ 'MT' , '593' ],
[ 'MT' , '594' ],
[ 'MT' , '595' ],
[ 'MT' , '596' ],
[ 'MT' , '597' ],
[ 'MT' , '598' ],
[ 'MT' , '599' ],
[ 'IL' , '600' ],
[ 'IL' , '601' ],
[ 'IL' , '602' ],
[ 'IL' , '603' ],
[ 'IL' , '604' ],
[ 'IL' , '605' ],
[ 'IL' , '606' ],
[ 'IL' , '607' ],
[ 'IL' , '608' ],
[ 'IL' , '609' ],
[ 'IL' , '610' ],
[ 'IL' , '611' ],
[ 'IL' , '612' ],
[ 'IL' , '613' ],
[ 'IL' , '614' ],
[ 'IL' , '615' ],
[ 'IL' , '616' ],
[ 'IL' , '617' ],
[ 'IL' , '618' ],
[ 'IL' , '619' ],
[ 'MO' , '620' ],
[ 'MO' , '622' ],
[ 'IL' , '623' ],
[ 'IL' , '624' ],
[ 'IL' , '625' ],
[ 'IL' , '626' ],
[ 'IL' , '627' ],
[ 'MO' , '628' ],
[ 'MO' , '629' ],
[ 'MO' , '630' ],
[ 'MO' , '631' ],
[ 'MO' , '633' ],
[ 'MO' , '634' ],
[ 'MO' , '635' ],
[ 'MO' , '636' ],
[ 'MO' , '637' ],
[ 'MO' , '638' ],
[ 'MO' , '639' ],
[ 'MO' , '640' ],
[ 'MO' , '641' ],
[ 'MO' , '644' ],
[ 'MO' , '645' ],
[ 'MO' , '646' ],
[ 'MO' , '647' ],
[ 'MO' , '648' ],
[ 'MO' , '649' ],
[ 'MO' , '650' ],
[ 'MO' , '651' ],
[ 'MO' , '652' ],
[ 'MO' , '653' ],
[ 'MO' , '654' ],
[ 'MO' , '655' ],
[ 'MO' , '656' ],
[ 'MO' , '657' ],
[ 'MO' , '658' ],
[ 'MO' , '660' ],
[ 'MO' , '661' ],
[ 'KS' , '662' ],
[ 'MO' , '664' ],
[ 'MO' , '665' ],
[ 'MO' , '666' ],
[ 'MO' , '667' ],
[ 'MO' , '668' ],
[ 'KS' , '669' ],
[ 'KS' , '670' ],
[ 'KS' , '671' ],
[ 'KS' , '672' ],
[ 'KS' , '673' ],
[ 'KS' , '674' ],
[ 'KS' , '675' ],
[ 'KS' , '676' ],
[ 'NE' , '677' ],
[ 'KS' , '678' ],
[ 'TX' , '679' ],
[ 'NE' , '680' ],
[ 'NE' , '681' ],
[ 'NE' , '683' ],
[ 'NE' , '684' ],
[ 'NE' , '685' ],
[ 'NE' , '686' ],
[ 'NE' , '687' ],
[ 'NE' , '688' ],
[ 'NE' , '689' ],
[ 'NE' , '690' ],
[ 'NE' , '691' ],
[ 'NE' , '692' ],
[ 'NE' , '693' ],
[ 'LA' , '700' ],
[ 'LA' , '701' ],
[ 'LA' , '703' ],
[ 'LA' , '704' ],
[ 'LA' , '705' ],
[ 'LA' , '706' ],
[ 'LA' , '707' ],
[ 'LA' , '708' ],
[ 'LA' , '710' ],
[ 'LA' , '711' ],
[ 'LA' , '712' ],
[ 'LA' , '713' ],
[ 'LA' , '714' ],
[ 'AR' , '716' ],
[ 'AR' , '717' ],
[ 'LA' , '718' ],
[ 'AR' , '719' ],
[ 'AR' , '720' ],
[ 'AR' , '721' ],
[ 'AR' , '722' ],
[ 'TN' , '723' ],
[ 'TN' , '724' ],
[ 'AR' , '725' ],
[ 'AR' , '726' ],
[ 'AR' , '727' ],
[ 'AR' , '728' ],
[ 'AR' , '729' ],
[ 'OK' , '730' ],
[ 'OK' , '731' ],
[ 'TX' , '733' ],
[ 'OK' , '734' ],
[ 'OK' , '735' ],
[ 'OK' , '736' ],
[ 'OK' , '737' ],
[ 'OK' , '738' ],
[ 'TX' , '739' ],
[ 'OK' , '740' ],
[ 'OK' , '741' ],
[ 'OK' , '743' ],
[ 'OK' , '744' ],
[ 'OK' , '745' ],
[ 'OK' , '746' ],
[ 'OK' , '747' ],
[ 'OK' , '748' ],
[ 'OK' , '749' ],
[ 'TX' , '750' ],
[ 'TX' , '751' ],
[ 'TX' , '752' ],
[ 'TX' , '753' ],
[ 'TX' , '754' ],
[ 'LA' , '755' ],
[ 'LA' , '756' ],
[ 'TX' , '757' ],
[ 'TX' , '758' ],
[ 'TX' , '759' ],
[ 'TX' , '760' ],
[ 'TX' , '761' ],
[ 'TX' , '762' ],
[ 'TX' , '763' ],
[ 'TX' , '764' ],
[ 'TX' , '765' ],
[ 'TX' , '766' ],
[ 'TX' , '767' ],
[ 'TX' , '768' ],
[ 'TX' , '769' ],
[ 'TX' , '770' ],
[ 'TX' , '772' ],
[ 'TX' , '773' ],
[ 'TX' , '774' ],
[ 'TX' , '775' ],
[ 'TX' , '776' ],
[ 'TX' , '777' ],
[ 'TX' , '778' ],
[ 'TX' , '779' ],
[ 'TX' , '780' ],
[ 'TX' , '781' ],
[ 'TX' , '782' ],
[ 'TX' , '783' ],
[ 'TX' , '784' ],
[ 'TX' , '785' ],
[ 'TX' , '786' ],
[ 'TX' , '787' ],
[ 'TX' , '788' ],
[ 'TX' , '789' ],
[ 'TX' , '790' ],
[ 'TX' , '791' ],
[ 'TX' , '792' ],
[ 'TX' , '793' ],
[ 'TX' , '794' ],
[ 'TX' , '795' ],
[ 'TX' , '796' ],
[ 'TX' , '797' ],
[ 'TX' , '798' ],
[ 'TX' , '799' ],
[ 'CO' , '800' ],
[ 'CO' , '801' ],
[ 'CO' , '802' ],
[ 'CO' , '803' ],
[ 'CO' , '804' ],
[ 'CO' , '805' ],
[ 'CO' , '806' ],
[ 'CO' , '807' ],
[ 'CO' , '808' ],
[ 'CO' , '809' ],
[ 'CO' , '810' ],
[ 'CO' , '811' ],
[ 'CO' , '812' ],
[ 'NM' , '813' ],
[ 'CO' , '814' ],
[ 'CO' , '815' ],
[ 'CO' , '816' ],
[ 'WY' , '820' ],
[ 'NL' , '821' ],
[ 'WY' , '822' ],
[ 'WY' , '823' ],
[ 'WY' , '824' ],
[ 'WY' , '825' ],
[ 'WY' , '826' ],
[ 'WY' , '827' ],
[ 'WY' , '828' ],
[ 'WY' , '829' ],
[ 'WY' , '830' ],
[ 'WY' , '831' ],
[ 'ID' , '832' ],
[ 'ID' , '833' ],
[ 'ID' , '834' ],
[ 'WA' , '835' ],
[ 'ID' , '836' ],
[ 'ID' , '837' ],
[ 'WA' , '838' ],
[ 'UT' , '840' ],
[ 'UT' , '841' ],
[ 'UT' , '842' ],
[ 'UT' , '843' ],
[ 'UT' , '844' ],
[ 'UT' , '845' ],
[ 'UT' , '846' ],
[ 'UT' , '847' ],
[ 'AZ' , '850' ],
[ 'AZ' , '851' ],
[ 'AZ' , '852' ],
[ 'AZ' , '853' ],
[ 'AZ' , '855' ],
[ 'AZ' , '856' ],
[ 'AZ' , '857' ],
[ 'AZ' , '859' ],
[ 'AZ' , '860' ],
[ 'AZ' , '863' ],
[ 'NV' , '864' ],
[ 'NM' , '865' ],
[ 'NM' , '870' ],
[ 'NM' , '871' ],
[ 'NM' , '873' ],
[ 'NM' , '874' ],
[ 'NM' , '875' ],
[ 'NM' , '876' ],
[ 'NM' , '877' ],
[ 'NM' , '878' ],
[ 'NM' , '879' ],
[ 'TX' , '880' ],
[ 'TX' , '881' ],
[ 'TX' , '882' ],
[ 'TX' , '883' ],
[ 'NM' , '884' ],
[ 'TX' , '885' ],
[ 'NV' , '889' ],
[ 'NV' , '890' ],
[ 'NV' , '891' ],
[ 'NV' , '893' ],
[ 'NV' , '894' ],
[ 'NV' , '895' ],
[ 'NV' , '897' ],
[ 'NV' , '898' ],
[ 'CA' , '900' ],
[ 'CA' , '901' ],
[ 'CA' , '902' ],
[ 'CA' , '903' ],
[ 'CA' , '904' ],
[ 'CA' , '905' ],
[ 'CA' , '906' ],
[ 'CA' , '907' ],
[ 'CA' , '908' ],
[ 'CA' , '910' ],
[ 'CA' , '911' ],
[ 'CA' , '912' ],
[ 'CA' , '913' ],
[ 'CA' , '914' ],
[ 'CA' , '915' ],
[ 'CA' , '916' ],
[ 'CA' , '917' ],
[ 'CA' , '918' ],
[ 'CA' , '919' ],
[ 'CA' , '920' ],
[ 'CA' , '921' ],
[ 'CA' , '922' ],
[ 'CA' , '923' ],
[ 'CA' , '924' ],
[ 'CA' , '925' ],
[ 'CA' , '926' ],
[ 'CA' , '927' ],
[ 'CA' , '928' ],
[ 'CA' , '930' ],
[ 'CA' , '931' ],
[ 'CA' , '932' ],
[ 'CA' , '933' ],
[ 'CA' , '934' ],
[ 'CA' , '935' ],
[ 'CA' , '936' ],
[ 'CA' , '937' ],
[ 'CA' , '938' ],
[ 'CA' , '939' ],
[ 'CA' , '940' ],
[ 'CA' , '941' ],
[ 'CA' , '942' ],
[ 'CA' , '943' ],
[ 'CA' , '944' ],
[ 'CA' , '945' ],
[ 'CA' , '946' ],
[ 'CA' , '947' ],
[ 'CA' , '948' ],
[ 'CA' , '949' ],
[ 'CA' , '950' ],
[ 'CA' , '951' ],
[ 'CA' , '952' ],
[ 'CA' , '953' ],
[ 'CA' , '954' ],
[ 'CA' , '955' ],
[ 'CA' , '956' ],
[ 'CA' , '957' ],
[ 'CA' , '958' ],
[ 'CA' , '959' ],
[ 'CA' , '960' ],
[ 'NV' , '961' ],
[ 'AP' , '962' ],
[ 'AP' , '963' ],
[ 'AP' , '964' ],
[ 'AP' , '965' ],
[ 'AP' , '966' ],
[ 'HI' , '967' ],
[ 'HI' , '968' ],
[ 'GU' , '969' ],
[ 'OR' , '970' ],
[ 'OR' , '971' ],
[ 'OR' , '972' ],
[ 'OR' , '973' ],
[ 'OR' , '974' ],
[ 'OR' , '975' ],
[ 'OR' , '976' ],
[ 'OR' , '977' ],
[ 'OR' , '978' ],
[ 'ID' , '979' ],
[ 'WA' , '980' ],
[ 'WA' , '981' ],
[ 'WA' , '982' ],
[ 'WA' , '983' ],
[ 'WA' , '984' ],
[ 'WA' , '985' ],
[ 'OR' , '986' ],
[ 'WA' , '988' ],
[ 'WA' , '989' ],
[ 'WA' , '990' ],
[ 'WA' , '991' ],
[ 'WA' , '992' ],
[ 'WA' , '993' ],
[ 'WA' , '994' ],
[ 'AK' , '995' ],
[ 'AK' , '996' ],
[ 'AK' , '997' ],
[ 'AK' , '998' ],
[ 'AK' , '999' ],
);

my @zones;

# only adds shipping zones for states listed in State
# so this would skip Puerto Rico for example
for my $zone (@us_postal_zones) {
    my ($state_iso_code, $postal_code) = @$zone;
    my $state = $schema->resultset("State")->find( { country_iso_code => 'US', state_iso_code => $state_iso_code } ); 
        if ($state) {
            push @zones,
                {
                    zone => 'US postal ' . $postal_code,
                    created => $now,
                    last_modified => $now,
                    zone_countries => [ { country_iso_code => 'US' } ],
                    zone_states => [ { states_id => $state->id } ],
                };
        }
}

my $pop_zones = \@zones;

$schema->resultset('Zone')->search({ zone => { -like => 'US postal %' } })->delete;

# populate zones table with new US postal zones.
$schema->populate(Zone => $pop_zones);

# populate deliverable countries
my @deliverable_countries = (
{ country_iso_code => 'AU' }, # Australia
{ country_iso_code => 'AT' }, # Austria
{ country_iso_code => 'BE' }, # Belgium
{ country_iso_code => 'CA' }, # Canada
{ country_iso_code => 'CZ' }, # Czech Republic
{ country_iso_code => 'DK' }, # Denmark
{ country_iso_code => 'DE' }, # Germany
{ country_iso_code => 'GR' }, # Greece
{ country_iso_code => 'HU' }, # Hungary
{ country_iso_code => 'IS' }, # Iceland
{ country_iso_code => 'IE' }, # Ireland
{ country_iso_code => 'IT' }, # Italy
{ country_iso_code => 'JP' }, # Japan
{ country_iso_code => 'KR' }, # South Korea
{ country_iso_code => 'LU' }, # Luxembourg
{ country_iso_code => 'MX' }, # Mexico
{ country_iso_code => 'NL' }, # Netherlands
{ country_iso_code => 'NO' }, # Norway
{ country_iso_code => 'PL' }, # Poland
{ country_iso_code => 'PT' }, # Portugal
{ country_iso_code => 'ES' }, # Spain
{ country_iso_code => 'SE' }, # Sweden
{ country_iso_code => 'CH' }, # Switzerland
{ country_iso_code => 'TR' }, # Turkey
{ country_iso_code => 'US' }, # United States
{ country_iso_code => 'GB' }, # United Kingdom
);

$schema->resultset('Zone')->create(
             {
                    zone => 'Deliverable Countries',
                    created => $now,
                    last_modified => $now,
                    zone_countries => \@deliverable_countries,
             }
);

